
設定大致流程:
1.設定時鐘源
2.設定觸發源(CNT)
3.ARR PSR設定
4.中斷
5.開下去
-------------------------------------------------------------------
TIMER的通道
capture/compare 做為輸出就是compare 作為輸入就是capture
--------------------------------------------------------------------
TIMx_CR1:
CKD: 取樣鐘分頻器
CKD 位 為控制CK_INT時鐘(timer的工作時鐘)，與對ETR、TIx等時鐘"的取樣時鐘"之間的時鐘，不是實際輸入的分頻

ARPE: ARR寄存器緩衝開關
如果有啟用ARPE
:CNT會數到原本的設定值，然後更新事件到來之後，才會用新的ARR(shadow)
如果沒有啟用ARPE
:CNT會數到當前ARR設定，也就是我還沒數到100前，我把ARR設成100，那他在100時就真的會停下來
(可以參考圖105跟106的差異)

CMS[1:0]: 中央對齊模式
00:邊緣對齊mode(不開的意思)，計數器依據方向位(DIR)向上或向下
下面三個差別只有中斷標誌位的觸發時機
01:對齊mode1。被設定為輸出的通道/的輸出中斷標誌位，只在向下計數時被設置。
10:對齊mode2。""""，只在向上計數時被設置。
11:對齊mode3。""""，在向上和向下計數時被設置。

DIR:計數方向位
0:向上
1:向下
注意:在中央對齊mode or 編碼器 mode 時，該位read only

OPM:One pulse mode 單脈衝開關(單次運作模式)
0不開 1:在發生下一次更新事件時，計數器停止(清除CEN位)。

URS:通過該bit 選擇那些情況下產生的UEV會產生(中斷或DMA請求)
0:以下任意情況產生的EUV都會產生中斷和DMA請求:上下數ovf，設定UG位，從模式下產生的更新。
1:只有上下數ovf可以產生中斷和DMA。

UDIS:更新停止位(Update disable)
該位藉由軟體設定或清除來允許/禁止UEV事件的產生。
0時:照一般產生UEV事件的方式產生，如下事件會產生UEV:
計數器上下數、設置UG位、從模式下產生的更新。
ARR、PSC、CCRx的緩衝們緊接著載入他們的遇載值。
1時:不產生更新事件，緩衝器保持他們的值，但counter和prescaler 在(UG位產生或接收到來自從控制器的硬件重設)時，還是會重新初始化。

CEN: conter enable,
就是個開關
注意:觸發模式可以藉由硬體自己啟動CEN
-----------------------------------------------------------------------
TIM_CR2:
TI1S:
0:TIMx_CH1引脚连到TI1输入;
1:TIMx_CH1、TIMx_CH2和TIMx_CH3引脚经异或后连到TI1输入。
见上一章13.3.18的与霍尔传感器的接口一节。

MMS:主模式選擇位:
MMS[2:0]:主模式选择 (Master mode selection)
这3位用于选择在主模式下送到从定时器的同步信息(TRGO)。

CCDS :capture /compare 事件發生時，DMA送出的時機選擇。
0:當CCx事件發生時，就送出DMA request
1:當發生"更新"事件時，送出DMA request
-------------------------------------------------------------------
TIMx_SMCR 從模式控制寄存器:

ETP:外部觸發極性:
0:高電位/上升沿有效
1:低電位/下降沿有效

ECE:外部時鐘 enable:外部時鐘模式2的開關
0 :停止外部時鐘模式2
1 :啟用外部時鐘模式2，計數器變成由 ETRF訊號上的有效邊緣觸發。
注意1:设置ECE位与选择外部时钟模式1并将TRGI连到ETRF(SMS=111和TS=111)具有相同功效。
注2:下述从模式可以与外部时钟模式2同时使用:复位模式、门控模式和触发模式;但是,这
时TRGI不能连到ETRF(TS位不能是’111’)。
注3:外部时钟模式1和外部时钟模式2同时被使能时,外部时钟的输入是ETRF。

ETPS[1:0] :外部觸發的分頻
重要注意:外部触发信号ETRP的频率必须最多是CK_INT频率的1/4。当输入较快的外部时钟时,可以使
用预分频降低ETRP的频率。
00:沒有分頻
01:ETRP / 2
10:ETRP / 4
11:ETRP / 8

ETF[3:0]:外部觸發的濾波
这些位定义了对ETRP信号采样的频率和对ETRP数字滤波的带宽。实际上,数字滤波器是一个
事件计数器,它记录到N个事件后会产生一个输出的跳变。

MSM:主/從模式選擇位
0:無作用
1:(触发输入(TRGI))/上的事件被延迟了,以允许在当前定时器(就是主)(通过TRGO)与它的从定时器间的
完美同步。这对要求把几个定时器同步到一个单一的外部事件时是非常有用的。

TS[2:0]觸發選擇
这3位选择用于/同步/计数器的触发输入。

SMS[2:0]:从模式选择 (Slave mode selection)
当选择了外部信号,触发信号(TRGI)的有效边沿与选中的外部输入极性相关(见输入控制寄存器
和控制寄存器的说明)
------------------------------------------------------------------------
TIMx_DIER:DMA/中斷觸發Enable 寄存器
就是DMA(前段)跟中斷(後段)是否啟用的控制位。

------------------------------------------------------------------------
TIMx_SR:Timerx狀態寄存器
-----------------------------------------------------------------------
TIMx_EGR:事件產生寄存器
專門產生一些事件用的
-------------------------------------------------------------
TIMx_CCMR1 && TIMx_CCMR2 捕获/比较模式寄存器
這兩組裡面都長一樣，分別都是兩組通道的控制寄存器組，剛好包含四個通道。






